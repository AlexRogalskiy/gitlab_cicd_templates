variables:
  GITLAB_CICD_IMAGE_REPO: registry.gitlab.com/getindata/dataops/ci-docker
  GITLAB_CICD_IMAGE_TAG: gcloudsdk-3e70bfd714b3faf3cf498591f107b68620bfb897
  BLOB_CONFIG_PATH: blob_args.json

dev:
  image: $GITLAB_CICD_IMAGE_REPO:$GITLAB_CICD_IMAGE_TAG
  stage: execute-dev
  extends:
    - .setup
  script:
    - dp compile --docker-build
    - dp deploy --blob-args $BLOB_CONFIG_PATH --datahub-ingest --docker-push
    - dp publish --key-path $GIT_KEY_PATH